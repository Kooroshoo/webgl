<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WebGL2 Two Triangles</title>
  <style>
    body {
      margin: 0;
      background: #111;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    canvas {
      border: 1px solid #fff;
    }
  </style>
</head>
<body>
  <canvas id="glCanvas" width="800" height="600"></canvas>
  <script>
    const canvas = document.getElementById('glCanvas');
    const gl = canvas.getContext('webgl2');
    if (!gl) {
      alert('WebGL2 not supported');
    }

    // Basic vertex and fragment shaders
    const vsSource = `#version 300 es
    layout(location = 0) in vec2 a_position;
    layout(location = 1) in vec3 a_color;

    out vec3 v_color;

    void main() {
      gl_Position = vec4(a_position, 0.0, 1.0);
      v_color = a_color;
    }`;

    const fsSource = `#version 300 es
    precision mediump float;

    in vec3 v_color;
    out vec4 outColor;

    void main() {
      outColor = vec4(v_color, 1.0);
    }`;

    function compileShader(type, source) {
      const shader = gl.createShader(type);
      gl.shaderSource(shader, source);
      gl.compileShader(shader);
      if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
        console.error(gl.getShaderInfoLog(shader));
        gl.deleteShader(shader);
        return null;
      }
      return shader;
    }

    const vs = compileShader(gl.VERTEX_SHADER, vsSource);
    const fs = compileShader(gl.FRAGMENT_SHADER, fsSource);

    const program = gl.createProgram();
    gl.attachShader(program, vs);
    gl.attachShader(program, fs);
    gl.linkProgram(program);
    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
      console.error(gl.getProgramInfoLog(program));
    }

    // Add Vertex Data (position + color)
    const triangle1 = new Float32Array([
      // x,    y,    r,  g,  b
      -0.3,  0.5,  1,  0,  0,  // top
      -0.8, -0.5,  0,  1,  0,  // bottom-left 
      0.2, -0.5,  0,  0,  1,  // bottom-right 
    ]);

    const triangle2 = new Float32Array([
      // x,    y,    r,  g,  b
      0.3,  0.5,  1,  1,  0,  // top
      -0.2, -0.5,  0,  1,  1,  // bottom-left 
      0.8, -0.5,  1,  0,  1,  // bottom-right 
    ]);

    // Define the total byte size of a single vertex (stride)
    const stride = 5 * Float32Array.BYTES_PER_ELEMENT;      

    // Create VAO and VBO for triangle 1
    const vao1 = gl.createVertexArray();    
    const vbo1 = gl.createBuffer();          
    gl.bindVertexArray(vao1);                
    gl.bindBuffer(gl.ARRAY_BUFFER, vbo1);    
    gl.bufferData(gl.ARRAY_BUFFER, triangle1, gl.STATIC_DRAW);   

    gl.enableVertexAttribArray(0);                                  
    gl.vertexAttribPointer(0, 2, gl.FLOAT, false, stride, 0);      
    gl.enableVertexAttribArray(1);                                                              
    gl.vertexAttribPointer(1, 3, gl.FLOAT, false, stride, 2 * Float32Array.BYTES_PER_ELEMENT);  

    // Create VAO and VBO for triangle 2
    const vao2 = gl.createVertexArray();    
    const vbo2 = gl.createBuffer();          
    gl.bindVertexArray(vao2);                
    gl.bindBuffer(gl.ARRAY_BUFFER, vbo2);    
    gl.bufferData(gl.ARRAY_BUFFER, triangle2, gl.STATIC_DRAW);   

    gl.enableVertexAttribArray(0);                                  
    gl.vertexAttribPointer(0, 2, gl.FLOAT, false, stride, 0);      
    gl.enableVertexAttribArray(1);                                                              
    gl.vertexAttribPointer(1, 3, gl.FLOAT, false, stride, 2 * Float32Array.BYTES_PER_ELEMENT);  

    // Unbind VAO and VBO to avoid accidentally modifying them later
    gl.bindVertexArray(null);
    gl.bindBuffer(gl.ARRAY_BUFFER, null);
    
    gl.viewport(0, 0, canvas.width, canvas.height);
    gl.clearColor(0.1, 0.1, 0.1, 1);
    gl.clear(gl.COLOR_BUFFER_BIT);
    gl.useProgram(program);

    // Draw triangle 1
    gl.bindVertexArray(vao1);
    gl.drawArrays(gl.TRIANGLES, 0, 3);

    // Draw triangle 2
    gl.bindVertexArray(vao2);
    gl.drawArrays(gl.TRIANGLES, 0, 3);

    gl.bindVertexArray(null);                                                

  </script>
</body>
</html>
